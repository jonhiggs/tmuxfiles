#!/usr/bin/env bash
source "$(dirname "$0")/../lib/bargraph.sh"

function _charge() {
  pmset -g batt               \
    | tail -n1                \
    | cut -d$'\t' -f2         \
    | awk -F\; '{ print $1 }' \
    | sed 's/[^0-9]//'
}

function battery_graph() {
  bargraph $(battery_charge)
}

charge=$(_charge)
if [[ ${charge} -gt 95 ]]; then
  color='#[fg=green]'
elif [[ ${charge} -lt 10 ]]; then
  color='#[fg=red]'
else
  color='#[fg=colour015]'
fi

printf "B %s%s#[fg=colour015]" "${color}" "$(bargraph "${charge}")"
